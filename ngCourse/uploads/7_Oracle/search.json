["© 2007 by Prentice Hall 13-1 Introduction to Oracle 10g Chapter 13 Database Administration James Perry and Gerald Post ","© 2007 by Prentice Hall 13-2 Chapter Outline • Overview of a DBA’s Duties • Using the Enterprise Manager • Understanding Oracle Storage Files • Conﬁguring Space for Schema Objects • Exporting and Importing Data • Maintaining the DBMS • Backing up the Database • Monitoring and Improving Database Performance • Obtaining Useful Information from System Views ","© 2007 by Prentice Hall 13-3 13.1 The Enterprise Manager main page Using the Enterprise Manager ","© 2007 by Prentice Hall 13-4 13.2 Enterprise Manager Administration page ","© 2007 by Prentice Hall 13-5 MarcouxK user Created in Chapter 13 Create new user Modify existing User account 13.3 Enterprise Manager Administration/Security/Users page ","© 2007 by Prentice Hall 13-6 13.4 Location of current control ﬁles Understanding Oracle storage ﬁles ","© 2007 by Prentice Hall 13-7 RWTablespace1 RW01.DBF RW02.DBF RW03.DBF Redwood indexes Redwood tables RWTablespace2 Segment Extent Data blocks RWI01.DBF 13.5 Oracle tablespaces and dataﬁles ","© 2007 by Prentice Hall 13-8 13.6 Sample tablespaces ","© 2007 by Prentice Hall 13-9 13.7 Creating a new dataﬁle ","© 2007 by Prentice Hall 13-10 13.8 Creating a new tablespace ","© 2007 by Prentice Hall 13-11 Data block Row data from inserts Administrative data overhead Free space PCTFREE 20% Reserved for Updates 13.9 Eﬀect of the PCTFREE parameter ","© 2007 by Prentice Hall 13-12 Table 13.1 Eﬀects of choosing PCTFREE value Smaller PCTFREE Less room for updates to existing table rows. Inserts fill the block with less wasted space. May require fewer total data blocks, saving space with faster retrieval. Larger PCTFREE More room for updates to existing table rows. May require more blocks. May improve Update performance because the database does not have to migrate rows. ","© 2007 by Prentice Hall 13-13 Table 13.2 Oracle recommendations for PCTFREE and PCTUSED Table Characteristics Settings Reasoning Default PCTFREE=10 PCTUSED=40 Default values for general purpose tables. Many UPDATE statements increase the size of rows. PCTFREE=20 PCTUSED=40 More free space to allow rows to grow. PCTUSED reduces processing during high update activity. Row sizes rarely change. PCTFREE=5 PCTUSED=60 Need less free space since row space can be reused. PCTUSED reduces wasted space, allowing space to be reused faster. Large table and most activity is read only. PCTFREE=5 PCTUSED=40 With a large table, you want to minimize the empty space. ","© 2007 by Prentice Hall 13-14 13.10 MetaLink patch search Maintaining the DBMS ","© 2007 by Prentice Hall 13-15 Table 13.3 Shutdown options Shutdown Command Option Description Shutdown normal (default) No new connections are allowed, but the system waits for all users to disconnect before shutting down. Shutdown transactional No new connections are allowed. No new transactions can be started. After all transactions are completed, the database shuts down. Shutdown immediate No new connections are allowed. No new transactions can be started. Uncommitted transactions are rolled back. Shutdown abort All transactions are terminated. Current SQL statements are terminated. The database will have to go through recovery when it restarts. Avoid this option except in emergencies. ","© 2007 by Prentice Hall 13-16 Main Oracle services Listener for Enterprise Manager Listener for i SQL*Plus Stop a service 13.11 Shutting down Oracle with the Windows service manager ","© 2007 by Prentice Hall 13-17 Table 13.4 Startup options Startup command option Description Startup Starts the instance, mounts the database, and allows everyone to log in. Startup nomount Starts the instance, but does not mount the database. Used when you want to create a new database. Startup mount Starts the instance, sets up the database, but does not open it. Used for configuring red logs files and performing full database recovery. Startup restrict Starts and mounts the database, but only certain users (DBAs) can log in. Useful when you need to export data, load large tables, or during upgrade migrations. ","© 2007 by Prentice Hall 13-18 Time Primary database Full backup copy Disk crash Redo Archive log Recovered database 13.12 Recovering an active database ","© 2007 by Prentice Hall 13-19 13.13 Conﬁguring the ArchiveLog property ","© 2007 by Prentice Hall 13-20 Table 13.5 Oracle ﬁle names and common locations File type Typical Name Typical Location Control File CONTROL01.CTL ORACLE_HOMEOradata DBName  SPFile SPFILE &lt;DBName&gt; .ORA ORACLE_HOME &lt;instance&gt; Database Password file PWD &lt;DBName&gt; .ORA ORACLE_HOMEDatabase Data Files SYSTEM01.DBF ORACLE_HOMEOradata DBName  Plus other locations if you create your own tablespaces and datafiles. Archive Logs Depends on what you entered. Flash Recovery Area ORACLE_HOMEflash_recovery_area Redo Logs REDO01.LOG ORACLE_HOMEOradata DBName  ","© 2007 by Prentice Hall 13-21 13.14 Metrics used for standard alerts Monitoring the DBMS ","© 2007 by Prentice Hall 13-22 Setup to enter e-mail server information Preferences General to enter your e-mail address Rules to pick events 13.15 Setting an alert to send you an e-mail message ","© 2007 by Prentice Hall 13-23 13.16 Default statistics in the performance monitor ","© 2007 by Prentice Hall 13-24 13.17 Performance monitor showing the top SQL commands ","© 2007 by Prentice Hall 13-25 Table 13.6 Tuning advisors Advisor Description ADDM Advisor The automatic analyzer examines usage, self-diagnoses problems, and recommends overall improvements. SQL Tuning Advisor Analyzes SQL statements and recommends rewrites to improve performance on individual queries. SQL Access Advisor Analyzes SQL statements and recommends indexes and materialized views. Memory Advisor Shared Pool Advisor Buffer Cache Advisor PGA Advisor Analyzes the use of system memory and can automatically reconfigure it for optimal performance. You can also run SGA and PGA advisors manually. Segment Advisor Analyzes segments to decide if you should run the shrink option to compact the space. It also maintains usage reports that are useful for capacity planning. Undo Advisor Identifies problems in the undo tablespace and helps set the optimal size, threshold values, and retention period for the undo and flashback segments. ","© 2007 by Prentice Hall 13-26 Select a time period Choose a finding 13.18 Automated performance analysis problems found ","© 2007 by Prentice Hall 13-27 13.19 Conﬁguring the ArchiveLog property ","© 2007 by Prentice Hall 13-28 13.20 Query execution plan Optimizing queries ","© 2007 by Prentice Hall 13-29 13.21 Tuning advisor recommendations ","© 2007 by Prentice Hall 13-30 13.22 Conﬁguring the SQL Access advisor ","© 2007 by Prentice Hall 13-31 Table 13.7 Common DBA views DBA View Description dba_views List of all views available to the DBA. Individual users can use user_views instead. dba_tab_commen ts List of comments for tables and views. dba_col_commen ts List of comments for specific columns. dba_tablespaces Data on tablespaces. Also look at dba_segments and dba_data_files. dba_tables List of table names and storage data. Also look at dba_indexes. dba_tab_cols List of columns in tables. dba_procedures List of procedures and functions in the database. Also look at dba_triggers. dba_sequences List of sequences in the database. dba_synonyms List of synonyms. Also look at dba_directories. dba_users List of all users. dba_roles List of all roles. dba_role_privs List of roles assigned to users (or other roles). dba_sys_privs List of system privileges assigned to users. dba_tab_privs List of all granted privileges in the database. ","© 2007 by Prentice Hall 13-32 Table 13.8 A few V$ performance views V$ View Description v$fixed_table v$fixed_view_definition A list of all V$, X$, and GV$ views. The SQL query used for each view. v$database v$instance v$tablespace v$datafile v$controlfile v$option v$version Configuration data about the database. v$open_cursor v$sql v$sqlarea v$sql_plan Cursors and SQL statements. V$ View Description v$sort_usage v$sysstat v$transaction v$osstat v$session v$session_wait_history v$lock v$locked_object Overall system and session performance. v$archive v$backup_datafile v$recovery_status v$recovery_file_dest v$rollstat v$undostat Archives, backup, and recovery, and rollback performance. "]